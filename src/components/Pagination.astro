---
// Pagination component
interface Props {
  currentPage: number
  totalPages: number
  baseUrl: string
}

const { currentPage, totalPages, baseUrl } = Astro.props

const safeCurrentPage = typeof currentPage === 'number' ? currentPage : 1
const safeTotalPages = typeof totalPages === 'number' ? totalPages : 1

// Generate page numbers to display
const getPageNumbers = (current: number, total: number) => {
  const pages: (number | string)[] = []
  const maxVisible = 7 // Max page numbers to show
  
  if (total <= maxVisible) {
    // Show all pages if total is small
    for (let i = 1; i <= total; i++) {
      pages.push(i)
    }
  } else {
    // Always show first page
    pages.push(1)
    
    if (current > 3) {
      pages.push('...')
    }
    
    // Show pages around current
    for (let i = Math.max(2, current - 1); i <= Math.min(total - 1, current + 1); i++) {
      pages.push(i)
    }
    
    if (current < total - 2) {
      pages.push('...')
    }
    
    // Always show last page
    pages.push(total)
  }
  
  return pages
}

const pageNumbers = getPageNumbers(safeCurrentPage, safeTotalPages)
---

<nav class="pagination">
  {/* Previous button */}
  {currentPage > 1 ? (
    <a href={`${baseUrl}?page=${currentPage - 1}`} class="pagination-btn">
      ← Previous
    </a>
  ) : (
    <span class="pagination-btn pagination-btn-disabled">
      ← Previous
    </span>
  )}

  {/* Page numbers */}
  <div class="pagination-numbers">
    {pageNumbers.map(page => (
      typeof page === 'number' ? (
        <a
          href={`${baseUrl}?page=${page}`}
          class={`pagination-number ${page === currentPage ? 'pagination-number-active' : ''}`}
        >
          {page}
        </a>
      ) : (
        <span class="pagination-ellipsis">{page}</span>
      )
    ))}
  </div>

  {/* Next button */}
  {currentPage < totalPages ? (
    <a href={`${baseUrl}?page=${currentPage + 1}`} class="pagination-btn">
      Next →
    </a>
  ) : (
    <span class="pagination-btn pagination-btn-disabled">
      Next →
    </span>
  )}
</nav>
